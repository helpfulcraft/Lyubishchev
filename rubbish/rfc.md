# RFC: 周期性时间报告系统

## 1. 摘要 (Summary)

本项目旨在扩展现有的时间统计工具，创建一个能够生成周期性（如周、月、年）时间分析报告的系统。该系统将利用每日记录并已累积在 `historical_data.csv` 文件中的数据，提供比日报更高维度的洞察。

## 2. 动机 (Motivation)

当前系统仅提供每日报告，虽然详尽，但缺乏对长时间跨度下时间分配模式的分析能力。为了进行更有效的个人规划和行为调整，用户需要回答诸如"我这个月的时间主要花在了哪里？"或"与上周相比，我这周在'第二类'上的投入是增加了还是减少了？"等问题。周期性报告正是为了满足这一核心需求。

## 3. 功能需求 (Functional Requirements)

### FR1: 周期性报告生成脚本
-   必须创建一个新的、独立的Python脚本，例如 `generate_periodic_report.py`。
-   该脚本必须能够接受时间范围作为输入参数，例如，能够指定生成"最近7天"、"上周"、"本月"或自定义起止日期的报告。

### FR2: 聚合数据视图 (默认视图)
-   生成的HTML报告页面在默认状态下，必须主要展示在指定周期内聚合后的数据。
-   内容应包括各大分类（Category）和子项（Item）的总时长统计。
-   报告中的图表应侧重于趋势与比较，例如，展示周期内每日总投入时间的柱状图，或各大分类在周期内总耗时的饼图/条形图。

### FR3: 交互式钻取详情 (Interactive Drill-Down)
-   为了避免信息过载，报告**不得**在默认视图下展示所有具体的、零散的任务（Task）列表。
-   必须提供交互功能。用户可以通过点击聚合视图中的某个分类或子项，来展开该项目的详情。
-   展开的详情区域中，应列出该项目下所有具体任务及其在**整个周期内的聚合总时长**（例如，如果本周玩了3次`er`，应显示为一条 `er: 11h`，而不是三条独立的记录）。
-   该详情区域必须是可再次折叠的，以便用户能返回简洁的聚合视图。

### FR4: 独立的报告产物
-   每次生成的周期性报告都应是一个独立的HTML文件，其命名应能反映其周期，例如 `report-weekly-2025-W24.html` 或 `report-monthly-2025-06.html`，以避免覆盖日常报告或其它周期报告。

## 4. 非功能性需求 (Non-Functional Requirements)

### NFR1: 性能
-   报告生成脚本应具备良好的性能，处理一整年的历史数据（约数千条记录）时，应在可接受的时间内（例如，10秒内）完成。

### NFR2: 可用性
-   前端报告的交互（如钻取详情）必须直观、流畅，无明显延迟。

## 5. 未来的可能性 (Future Possibilities)
-   支持多周期对比，例如"本月 vs 上月"。
-   通过UI界面（而非命令行）选择日期范围。
-   引入更丰富的图表类型，如桑基图（Sankey Diagram）来分析时间流向。 